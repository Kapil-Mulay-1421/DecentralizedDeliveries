{"ast":null,"code":"import _regeneratorRuntime from\"D:/Kapil D/Personal/DecentralizedDeliveries/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Kapil D/Personal/DecentralizedDeliveries/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Kapil D/Personal/DecentralizedDeliveries/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import useEth from\"../contexts/EthContext/useEth\";import Axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var serverUrl='http://localhost:3000/deliveries/';var userAddress=null;var ProclaimDelivery=function ProclaimDelivery(){var _useEth=useEth(),_useEth$state=_useEth.state,contract=_useEth$state.contract,accounts=_useEth$state.accounts;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),deliveryRequests=_useState2[0],setDeliveryRequests=_useState2[1];if(accounts!=null){userAddress=accounts[0];}if(userAddress!=null){Axios.get(serverUrl+'deliveryMan/'+userAddress).then(function(response){setDeliveryRequests(response.data);});}var proclaimDelivery=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(index){var hash;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:hash=deliveryRequests[index]._id;if(!(hash==='')){_context.next=4;break;}alert('There was some problem. Please try again.');return _context.abrupt(\"return\");case 4:_context.prev=4;_context.next=7;return contract.methods.allegeDelivery(hash).send({from:accounts[0]}).then(function(response){console.log(response);});case 7:_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](4);alert(\"Invalid delivery key.\");case 12:case\"end\":return _context.stop();}}},_callee,null,[[4,9]]);}));return function proclaimDelivery(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Proclaim your delivery\"}),/*#__PURE__*/_jsxs(\"table\",{style:{border:\"1px solid black\"},children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid black\",padding:\"10px\"},children:\"Index\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid black\",padding:\"10px\"},children:\"Item\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid black\",padding:\"10px\"},children:\"Pickup From\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid black\",padding:\"10px\"},children:\"Deliver To\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid black\",padding:\"10px\"},children:\"Reward\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:\"1px solid black\",padding:\"10px\"},children:\"Accept Delivery\"})]}),deliveryRequests!=null?deliveryRequests.map(function(req,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{style:{border:\"1px solid black\",padding:\"10px\"},children:index+1}),/*#__PURE__*/_jsx(\"td\",{style:{border:\"1px solid black\",padding:\"3px\"},children:req.item}),/*#__PURE__*/_jsx(\"td\",{style:{border:\"1px solid black\",padding:\"3px\"},children:req.from}),/*#__PURE__*/_jsx(\"td\",{style:{border:\"1px solid black\",padding:\"3px\"},children:req.to}),/*#__PURE__*/_jsx(\"td\",{style:{border:\"1px solid black\",padding:\"3px\"},children:req.payment}),/*#__PURE__*/_jsx(\"td\",{style:{border:\"1px solid black\",padding:\"10px\"},children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return proclaimDelivery(index);},children:\"Proclaim\"})})]});}):console.log(\"deliveryRequests was null.\")]}),deliveryRequests!=null?deliveryRequests.length==0?\"No delivery requests yet.\":null:null]});};export default ProclaimDelivery;","map":{"version":3,"names":["React","useState","useEth","Axios","serverUrl","userAddress","ProclaimDelivery","state","contract","accounts","deliveryRequests","setDeliveryRequests","get","then","response","data","proclaimDelivery","index","hash","_id","alert","methods","allegeDelivery","send","from","console","log","border","padding","map","req","item","to","payment","length"],"sources":["D:/Kapil D/Personal/DecentralizedDeliveries/client/src/components/ProclaimDelivery.jsx"],"sourcesContent":["import React, {useState} from 'react'\r\nimport useEth from \"../contexts/EthContext/useEth\";\r\nimport Axios from 'axios'\r\n\r\nconst serverUrl = 'http://localhost:3000/deliveries/'\r\nlet userAddress = null;\r\n\r\nconst ProclaimDelivery = () => {\r\n  \r\n    const { state: { contract, accounts } } = useEth();\r\n    const [deliveryRequests, setDeliveryRequests] = useState([])\r\n    if(accounts != null) {\r\n      userAddress = accounts[0]\r\n    }\r\n\r\n    if(userAddress != null) {\r\n      Axios.get(serverUrl+'deliveryMan/' + userAddress).then(response => {\r\n        setDeliveryRequests(response.data)\r\n      })\r\n    }\r\n\r\n    const proclaimDelivery = async (index) => {\r\n      const hash = deliveryRequests[index]._id\r\n      if(hash === '') {\r\n        alert('There was some problem. Please try again.');\r\n        return;\r\n      }\r\n      try {\r\n        await contract.methods.allegeDelivery(hash).send({from: accounts[0]}).then((response) => {\r\n          console.log(response)\r\n        })\r\n      } catch(err) {\r\n        alert(\"Invalid delivery key.\")\r\n      }\r\n    }\r\n\r\n  return (\r\n    <div>\r\n        <h1>Proclaim your delivery</h1>\r\n        <table style={{border: \"1px solid black\"}}>\r\n          <tr>\r\n            <th style={{border: \"1px solid black\", padding: \"10px\"}}>Index</th>\r\n            <th style={{border: \"1px solid black\", padding: \"10px\"}}>Item</th>\r\n            <th style={{border: \"1px solid black\", padding: \"10px\"}}>Pickup From</th>\r\n            <th style={{border: \"1px solid black\", padding: \"10px\"}}>Deliver To</th>\r\n            <th style={{border: \"1px solid black\", padding: \"10px\"}}>Reward</th>\r\n            <th style={{border: \"1px solid black\", padding: \"10px\"}}>Accept Delivery</th>\r\n          </tr>\r\n          {deliveryRequests != null ? deliveryRequests.map((req, index) =>  {\r\n            return (\r\n              <tr>\r\n                <td style={{border: \"1px solid black\", padding: \"10px\"}}>{index+1}</td>\r\n                <td style={{border: \"1px solid black\", padding: \"3px\"}}>{req.item}</td>\r\n                <td style={{border: \"1px solid black\", padding: \"3px\"}}>{req.from}</td>\r\n                <td style={{border: \"1px solid black\", padding: \"3px\"}}>{req.to}</td>\r\n                <td style={{border: \"1px solid black\", padding: \"3px\"}}>{req.payment}</td>\r\n                <td style={{border: \"1px solid black\", padding: \"10px\"}}><button onClick={() => proclaimDelivery(index)}>Proclaim</button></td>\r\n              </tr>\r\n            )\r\n          }): console.log(\"deliveryRequests was null.\")}\r\n        </table>\r\n        {deliveryRequests != null ? deliveryRequests.length == 0 ? \"No delivery requests yet.\" : null : null}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ProclaimDelivery"],"mappings":"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"},"metadata":{},"sourceType":"module"}