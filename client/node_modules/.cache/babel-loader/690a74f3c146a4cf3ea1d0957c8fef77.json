{"ast":null,"code":"var _jsxFileName = \"D:\\\\Kapil D\\\\Personal\\\\DecentralizedDeliveries\\\\client\\\\src\\\\components\\\\RequestDelivery.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport useEth from \"../contexts/EthContext/useEth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet listeningToAllegeEvent = false;\nlet listeningToAcceptEvent = false;\n\nconst RequestDelivery = () => {\n  _s();\n\n  const {\n    state: {\n      contract,\n      accounts\n    }\n  } = useEth();\n  const [to, setTo] = useState('');\n  const [from, setFrom] = useState('');\n  const [item, setItem] = useState('');\n  const [value, setValue] = useState(0);\n  window.allegeEvent = null;\n  const [requests, setRequests] = useState([]); // starting listener for Accept Event.\n\n  if (contract != null && !listeningToAcceptEvent) {\n    window.acceptEvent = contract.events.AcceptEvent().on(\"data\", function (log) {\n      handleAccept(log);\n    });\n    listeningToAcceptEvent = true;\n  } // starting listener for Allege Event.\n\n\n  if (contract != null && !listeningToAllegeEvent) {\n    window.allegeEvent = contract.events.AllegeEvent().on(\"data\", function (log) {\n      handleAllege(log);\n    });\n    listeningToAllegeEvent = true;\n  }\n\n  const handleInput = e => {\n    switch (e.target.name) {\n      case 'to':\n        setTo(e.target.value);\n        break;\n\n      case 'from':\n        setFrom(e.target.value);\n        break;\n\n      case 'item':\n        setItem(e.target.value);\n        break;\n\n      case 'value':\n        setValue(e.target.value);\n        break;\n\n      default:\n        alert('Invalid input source.');\n        break;\n    }\n  };\n\n  const handleSubmit = async () => {\n    // Validation: \n    if (to === '' || from === '' || item === '' || value === 0) {\n      alert(\"Please fill in all the values.\");\n      return;\n    } // Calling Contract if validation succeeds: \n\n\n    await contract.methods.requestDelivery(to, from, item).send({\n      from: accounts[0],\n      value: value\n    }).then(response => {\n      console.log(response);\n      let tempArray = requests;\n      tempArray.push(response.events.RequestEvent.returnValues.requestId);\n      setRequests(tempArray);\n    });\n  };\n\n  window.handleConfirm = async index => {\n    let requestId = requests[index];\n    await contract.methods.confirm(requestId).send({\n      from: accounts[0]\n    });\n  };\n\n  const handleAccept = log => {\n    let requestId = log.returnValues.requestId;\n\n    if (requests.includes(requestId)) {\n      let deliveryMan = log.returnValues.deliveryMan;\n      document.getElementById('wrapper').insertAdjacentHTML('beforeend', '<p>Request ' + requestId + ' has been accepted by ' + deliveryMan + '</p>');\n    }\n  };\n\n  const handleAllege = log => {\n    let requestId = log.returnValues.requestId;\n\n    if (requests.includes(requestId)) {\n      let index = requests.indexOf(requestId);\n      document.getElementById('wrapper').insertAdjacentHTML('beforeend', '<p>Requesting delivery confirmation of requestId ' + requestId + '</p>' + '<button onClick=\"window.handleConfirm(' + index + ')\">Confirm</button>');\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Request a Delivery\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"to\",\n      children: \"Delivery Destination: \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"to\",\n      onChange: handleInput\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"from\",\n      children: \"Pickup From: \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"from\",\n      onChange: handleInput\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"item\",\n      children: \"Pick this up: \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"item\",\n      onChange: handleInput\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"value\",\n      children: \"Attach payment(in wei): \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"number\",\n      name: \"value\",\n      onChange: handleInput\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSubmit,\n      children: \"Submit\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n};\n\n_s(RequestDelivery, \"HqvWA3fqEt/1r6QUUGx1Imw+4TU=\", false, function () {\n  return [useEth];\n});\n\n_c = RequestDelivery;\nexport default RequestDelivery;\n\nvar _c;\n\n$RefreshReg$(_c, \"RequestDelivery\");","map":{"version":3,"names":["React","useState","useEth","listeningToAllegeEvent","listeningToAcceptEvent","RequestDelivery","state","contract","accounts","to","setTo","from","setFrom","item","setItem","value","setValue","window","allegeEvent","requests","setRequests","acceptEvent","events","AcceptEvent","on","log","handleAccept","AllegeEvent","handleAllege","handleInput","e","target","name","alert","handleSubmit","methods","requestDelivery","send","then","response","console","tempArray","push","RequestEvent","returnValues","requestId","handleConfirm","index","confirm","includes","deliveryMan","document","getElementById","insertAdjacentHTML","indexOf"],"sources":["D:/Kapil D/Personal/DecentralizedDeliveries/client/src/components/RequestDelivery.jsx"],"sourcesContent":["import React, {useState} from 'react'\r\nimport useEth from \"../contexts/EthContext/useEth\";\r\n\r\nlet listeningToAllegeEvent = false;\r\nlet listeningToAcceptEvent = false;\r\n\r\nconst RequestDelivery = () => {\r\n  const { state: { contract, accounts } } = useEth();\r\n\r\n  const [to, setTo] = useState('')\r\n  const [from, setFrom] = useState('')\r\n  const [item, setItem] = useState('')\r\n  const [value, setValue] = useState(0)\r\n  window.allegeEvent = null;\r\n  const [requests, setRequests] = useState([])\r\n\r\n\r\n  // starting listener for Accept Event.\r\n  if (contract != null && !listeningToAcceptEvent) {\r\n    window.acceptEvent = contract.events.AcceptEvent()\r\n    .on(\"data\", function(log) {\r\n      handleAccept(log);\r\n    })\r\n    listeningToAcceptEvent = true;\r\n  }\r\n\r\n  // starting listener for Allege Event.\r\n  if (contract != null && !listeningToAllegeEvent) {\r\n    window.allegeEvent = contract.events.AllegeEvent()\r\n    .on(\"data\", function(log) {\r\n      handleAllege(log);\r\n    })\r\n    listeningToAllegeEvent = true;\r\n  }\r\n\r\n  const handleInput = e => {\r\n    switch(e.target.name) {\r\n        case 'to': \r\n            setTo(e.target.value);\r\n            break;\r\n        case 'from':\r\n            setFrom(e.target.value);\r\n            break;\r\n        case 'item': \r\n            setItem(e.target.value);\r\n            break;\r\n        case 'value': \r\n            setValue(e.target.value);\r\n            break;\r\n        default: \r\n            alert('Invalid input source.')\r\n            break;\r\n    }\r\n  }\r\n\r\n  const handleSubmit = async () => {\r\n    // Validation: \r\n    if (to === '' || from === '' || item === '' || value === 0) {\r\n        alert(\"Please fill in all the values.\")\r\n        return;\r\n    }\r\n\r\n    // Calling Contract if validation succeeds: \r\n    await contract.methods.requestDelivery(to, from, item).send({from: accounts[0], value: value}).then((response) => {\r\n      console.log(response)\r\n      let tempArray = requests\r\n      tempArray.push(response.events.RequestEvent.returnValues.requestId)\r\n      setRequests(tempArray)\r\n    })\r\n  }\r\n\r\n  window.handleConfirm = async (index) => {\r\n    let requestId = requests[index]\r\n    await contract.methods.confirm(requestId).send({from: accounts[0]})\r\n  }\r\n\r\n  const handleAccept = (log) => {\r\n    let requestId = log.returnValues.requestId\r\n    if (requests.includes(requestId)) {\r\n      let deliveryMan = log.returnValues.deliveryMan\r\n      document.getElementById('wrapper').insertAdjacentHTML('beforeend', \r\n                                                            '<p>Request ' + requestId + ' has been accepted by '+ deliveryMan +'</p>')\r\n    }\r\n  }\r\n\r\n  const handleAllege = (log) => {\r\n    let requestId = log.returnValues.requestId\r\n    if (requests.includes(requestId)) {\r\n      let index = requests.indexOf(requestId)\r\n      document.getElementById('wrapper').insertAdjacentHTML('beforeend', \r\n                                                            '<p>Requesting delivery confirmation of requestId ' + requestId + '</p>' + \r\n                                                            '<button onClick=\"window.handleConfirm('+ index +')\">Confirm</button>')\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div id='wrapper'>\r\n        <h1>Request a Delivery</h1>\r\n        <label htmlFor=\"to\">Delivery Destination: </label>\r\n        <input type=\"text\" name='to' onChange={handleInput}/>\r\n\r\n        <label htmlFor=\"from\">Pickup From: </label>\r\n        <input type=\"text\" name='from' onChange={handleInput}/>\r\n\r\n        <label htmlFor=\"item\">Pick this up: </label>\r\n        <input type=\"text\" name='item' onChange={handleInput} />\r\n\r\n        <label htmlFor=\"value\">Attach payment(in wei): </label>\r\n        <input type=\"number\" name='value' onChange={handleInput} />\r\n\r\n        <button onClick={handleSubmit}>Submit</button>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default RequestDelivery"],"mappings":"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"},"metadata":{},"sourceType":"module"}