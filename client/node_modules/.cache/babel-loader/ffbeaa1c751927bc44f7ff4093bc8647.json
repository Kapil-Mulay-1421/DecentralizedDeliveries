{"ast":null,"code":"import _regeneratorRuntime from\"D:/Kapil D/Personal/DecentralizedDeliveries/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Kapil D/Personal/DecentralizedDeliveries/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useRef}from'react';import useEth from\"../contexts/EthContext/useEth\";import Axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var serverUrl='http://localhost:3000/deliveries/';var userAddress=null;var deliveryRequests=null;var AcceptDelivery=function AcceptDelivery(){var _useEth=useEth(),_useEth$state=_useEth.state,contract=_useEth$state.contract,accounts=_useEth$state.accounts;if(accounts!=null){userAddress=accounts[0];}if(userAddress!=null){Axios.get(serverUrl+'stage/0').then(function(response){deliveryRequests=response.data;});}var deliveryHash=useRef('');var acceptDelivery=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var hash;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:hash=deliveryHash.current.value;if(!(hash==='')){_context.next=4;break;}alert('Please enter the delivery key');return _context.abrupt(\"return\");case 4:_context.prev=4;_context.next=7;return contract.methods.acceptDelivery(hash).send({from:accounts[0]}).then(function(response){console.log(response);});case 7:_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](4);alert(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[4,9]]);}));return function acceptDelivery(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Make a Delivery\"}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Item\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Pickup From\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Deliver To\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Reward\"})]}),deliveryRequests!=null?deliveryRequests.map(function(req,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:req.item}),/*#__PURE__*/_jsx(\"td\",{children:req.from}),/*#__PURE__*/_jsx(\"td\",{children:req.to}),/*#__PURE__*/_jsx(\"td\",{children:req.payment})]});}):null]}),deliveryRequests.length==0?\"No delivery requests yet.\":null]});};export default AcceptDelivery;","map":{"version":3,"names":["React","useRef","useEth","Axios","serverUrl","userAddress","deliveryRequests","AcceptDelivery","state","contract","accounts","get","then","response","data","deliveryHash","acceptDelivery","hash","current","value","alert","methods","send","from","console","log","map","req","index","item","to","payment","length"],"sources":["D:/Kapil D/Personal/DecentralizedDeliveries/client/src/components/AcceptDelivery.jsx"],"sourcesContent":["import React, {useRef} from 'react'\r\nimport useEth from \"../contexts/EthContext/useEth\";\r\nimport Axios from 'axios'\r\n\r\nconst serverUrl = 'http://localhost:3000/deliveries/'\r\nlet userAddress = null;\r\nlet deliveryRequests = null;\r\n\r\nconst AcceptDelivery = () => {\r\n  \r\n    const { state: { contract, accounts } } = useEth()\r\n    if(accounts != null) {\r\n      userAddress = accounts[0]\r\n    }\r\n\r\n    if(userAddress != null) {\r\n      Axios.get(serverUrl+'stage/0').then(response => {\r\n        deliveryRequests = response.data\r\n      })\r\n    }\r\n\r\n    const deliveryHash = useRef('');\r\n\r\n    const acceptDelivery = async () => {\r\n      const hash = deliveryHash.current.value;\r\n      if(hash === '') {\r\n        alert('Please enter the delivery key');\r\n        return;\r\n      }\r\n      try {\r\n        await contract.methods.acceptDelivery(hash).send({from: accounts[0]}).then((response) => {\r\n          console.log(response)\r\n        })\r\n      } catch(err) {\r\n        alert(err)\r\n      }\r\n    }\r\n\r\n  return (\r\n    <div>\r\n        <h1>Make a Delivery</h1>\r\n        <table>\r\n          <tr>\r\n            <th>Item</th>\r\n            <th>Pickup From</th>\r\n            <th>Deliver To</th>\r\n            <th>Reward</th>\r\n          </tr>\r\n          {deliveryRequests != null ? deliveryRequests.map((req, index) =>  {\r\n            return (\r\n              <tr>\r\n                <td>{req.item}</td>\r\n                <td>{req.from}</td>\r\n                <td>{req.to}</td>\r\n                <td>{req.payment}</td>\r\n              </tr>\r\n            )\r\n          }): null}\r\n        </table>\r\n        {deliveryRequests.length == 0 ? \"No delivery requests yet.\" : null}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default AcceptDelivery"],"mappings":"gSAAA,MAAOA,MAAP,EAAeC,MAAf,KAA4B,OAA5B,CACA,MAAOC,OAAP,KAAmB,+BAAnB,CACA,MAAOC,MAAP,KAAkB,OAAlB,C,wFAEA,GAAMC,UAAS,CAAG,mCAAlB,CACA,GAAIC,YAAW,CAAG,IAAlB,CACA,GAAIC,iBAAgB,CAAG,IAAvB,CAEA,GAAMC,eAAc,CAAG,QAAjBA,eAAiB,EAAM,CAEzB,YAA0CL,MAAM,EAAhD,uBAAQM,KAAR,CAAiBC,QAAjB,eAAiBA,QAAjB,CAA2BC,QAA3B,eAA2BA,QAA3B,CACA,GAAGA,QAAQ,EAAI,IAAf,CAAqB,CACnBL,WAAW,CAAGK,QAAQ,CAAC,CAAD,CAAtB,CACD,CAED,GAAGL,WAAW,EAAI,IAAlB,CAAwB,CACtBF,KAAK,CAACQ,GAAN,CAAUP,SAAS,CAAC,SAApB,EAA+BQ,IAA/B,CAAoC,SAAAC,QAAQ,CAAI,CAC9CP,gBAAgB,CAAGO,QAAQ,CAACC,IAA5B,CACD,CAFD,EAGD,CAED,GAAMC,aAAY,CAAGd,MAAM,CAAC,EAAD,CAA3B,CAEA,GAAMe,eAAc,4FAAG,8IACfC,IADe,CACRF,YAAY,CAACG,OAAb,CAAqBC,KADb,MAElBF,IAAI,GAAK,EAFS,0BAGnBG,KAAK,CAAC,+BAAD,CAAL,CAHmB,8EAObX,SAAQ,CAACY,OAAT,CAAiBL,cAAjB,CAAgCC,IAAhC,EAAsCK,IAAtC,CAA2C,CAACC,IAAI,CAAEb,QAAQ,CAAC,CAAD,CAAf,CAA3C,EAAgEE,IAAhE,CAAqE,SAACC,QAAD,CAAc,CACvFW,OAAO,CAACC,GAAR,CAAYZ,QAAZ,EACD,CAFK,CAPa,uFAWnBO,KAAK,aAAL,CAXmB,oEAAH,kBAAdJ,eAAc,0CAApB,CAeF,mBACE,oCACI,uCADJ,cAEI,sCACE,mCACE,4BADF,cAEE,mCAFF,cAGE,kCAHF,cAIE,8BAJF,GADF,CAOGV,gBAAgB,EAAI,IAApB,CAA2BA,gBAAgB,CAACoB,GAAjB,CAAqB,SAACC,GAAD,CAAMC,KAAN,CAAiB,CAChE,mBACE,mCACE,oBAAKD,GAAG,CAACE,IAAT,EADF,cAEE,oBAAKF,GAAG,CAACJ,IAAT,EAFF,cAGE,oBAAKI,GAAG,CAACG,EAAT,EAHF,cAIE,oBAAKH,GAAG,CAACI,OAAT,EAJF,GADF,CAQD,CAT2B,CAA3B,CASG,IAhBN,GAFJ,CAoBKzB,gBAAgB,CAAC0B,MAAjB,EAA2B,CAA3B,CAA+B,2BAA/B,CAA6D,IApBlE,GADF,CAwBD,CAtDD,CAwDA,cAAezB,eAAf"},"metadata":{},"sourceType":"module"}